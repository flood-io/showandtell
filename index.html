<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Flood IO</title>

    <meta name="description" content="Distributed load testing with Flood IO">
    <meta name="author" content="Flood IO">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/league.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="css/highlight/styles/zenburn.css" id="highlight-theme">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <link rel="stylesheet" href="css/custom.css">

  </head>

  <body>

    <div class="reveal">
      <div class="slides"><section id="hello" class="slide" data-background="images/wave-large.jpg">
<p><img src="images/flood-icon-white.png" alt=""></p>
</section>
<section id="it-scales" class="slide">
<blockquote>
<p>Distributed, Loosely Coupled, Shared Nothing Load Test Platform</p>
</blockquote>
<p>(it scales)</p><aside class="notes"><p>A distributed system in which components located on networked computers communicate and coordinate their actions by passing messages to each other where each of its components has, or makes use of, little or no knowledge of the definitions of other separate components in a distributed computing architecture in which each node is independent and self-sufficient, and there is no single point of contention across the system.</p></aside>
</section>
<section id="it-scales-because" class="slide">
<blockquote>
<p>It scales because</p>
</blockquote>
<p><img src="images/it-scales-because.png" alt=""></p><aside class="notes"><p>Take a single node on EC2, typically an m4.xlarge with 15GB RAM and 4 VCPUs and we then tune the crap out of the related tools which are mostly JVMs inside docker containers running popular open source tools like JMeter, Gatling and Selenium.</p></aside>
</section>
<section id="jon-snow-nodes" class="slide">
<p><img src="images/load-test-tools.png" alt=""></p>
<p><img src="images/jon-snow.gif" alt=""></p>
</section>
<section id="grid-nodes" class="slide">
<p><img src="images/grid-nodes.png" alt=""></p>
</section>
<section id="upload-test-files" class="slide">
<p><img src="images/upload-test-files.png" alt=""></p>
</section>
<section id="select-grids" class="slide">
<p><img src="images/select-grids.png" alt=""></p>
</section>
<section id="results-real-time" class="slide" data-background="images/results-real-time.png">

</section>
<section id="marketing" class="slide" data-background="images/marketing.jpg">

</section>
<section id="irl" class="slide" data-background="images/irl.gif">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.7); color: #fff; padding: 50px;">

<ul>
<li>Tim Koopmans</li>
<li>CTO / Founder <a href="https://flood/io">Flood IO</a></li>
<li>Cow Farmer</li>
<li>Child Wrangler</li>
<li>Know a few things about load testing</li>
</ul>
</section>
<section id="how-to-scale" class="slide" data-background="images/screaming_flood_io.jpg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;"><h2 style="color:white">How to scale from zero to one million requests per second</h2></div>
</section>
<section id="one-million-dollars" class="slide" data-background="images/one-million-dollars.gif">

</section>
<section id="why" class="slide" data-background="images/bums-on-seats.jpeg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<h2>Tip: Ask Why?</h2><blockquote>
<p>&quot;A good simulation model is worth a thousand tests&quot;</p>
</blockquote>
</section>
<section id="google-analytics" class="slide" data-background="images/google-analytics.png">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<blockquote>
<p>&quot;Last night we had 180K uniques doing something in the order of 500K requests per minute BUT the business wants us to test up to 1M requests per second for the next sale&quot;</p>
</blockquote>
</section>
<section id="concurrency-1" class="slide" data-background="images/crowd.jpeg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<h2>Estimating concurrency</h2><p>We can estimate with uniques and session duration</p>
<pre>

           180,000 uniques
           ---------------        = 15,000 concurrent users
      ( 60 minutes / 5 minutes)

</pre>
</section>
<section id="concurrency-2" class="slide">
<h2>Tip: They don&#39;t exist</h2><blockquote>
<p>&quot;uniform hourly distributions&quot;</p>
</blockquote>
<p><img src="images/poisson.jpg" alt=""></p>
</section>
<section id="throughput-1" class="slide" data-background="images/throughput.jpeg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<h2>Estimating throughput</h2><p>We also need to estimate throughput 😳</p>
<pre>

   500,000 requests per minute
   ---------------------------  = 33 rpm per user
        15,000 users

</pre>
</section>
<section id="throughput-2" class="slide" data-background="images/turbo.jpeg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<h2>Estimating throughput</h2><p>We can start to validate business targets of 1M rps 😲</p>
<pre>
  60,000,000 requests per minute
  ------------------------------  = 4,000 rpm per user
        15,000 users

            OR maybe ...

  60,000,000 requests per minute
  ------------------------------  = 1.8M concurrent users
        33 rpm per user
</pre>
</section>
<section id="preparation-model" class="slide" data-background="images/prepare.jpg">
<div style="border-radius: 10px;background-color: rgba(0, 0, 0, 0.8); color: #fff; padding: 50px;">

<h2>Preparation</h2><p>☑️ Model</p>
<p>🗳 Script</p>
<p>🗳 Monitors</p>
</section>
<section id="sequence-diagram" class="slide" data-background="images/sequence_diagram.jpg">

</section>
<section id="charles" class="slide" data-background="images/charles.png">

</section>
<section id="jmeter-eyes" class="slide" data-background="images/jmeter-eyes.jpg">

</section>
<section id="jmeter-ui" class="slide" data-background="images/jmeter-ui.png">

</section>
<section id="ruby-jmeter" class="slide">
<h2>Ruby-JMeter</h2><pre><code class="ruby">
require 'ruby-jmeter'

test do
  defaults  domain: 'flooded.io', port: 443, protocol: 'https'

  with_user_agent :iphone

  header [
    { name: 'Accept', value: 'application/json' }
  ]

  threads count: 100 do

    random_timer 100, 200

    get name: 'entry point', url: '/v2', sample: 10 do
      assert json: '.status', value: 'OK'
    end

    post name: 'create session', url: '/v2/oauth', sample: 10,
      fill_in: {
        username: 'Michel Rosen',
        password: 4141414141
      } do
        extract json: '.access_token', name: 'access_token'
      with_xhr
    end
  end
end.jmx
</code></pre>
</section>
<section id="demo-code" class="slide">
<h2>Demo Code</h2><p><a href="https://github.com/flood-io/loadtest">https://github.com/flood-io/loadtest</a></p>
<pre><code>
├── Dockerfile
├── Makefile
├── README.md
├── config
│   ├── default.vcl
│   ├── limits.conf
│   ├── nginx.conf
│   ├── supervisord.conf
│   └── sysctl.conf
├── docs
│   ├── demo_requests.chls
├── scripts
│   └── jenkins.sh
├── terraform
│   ├── api
│   │   ├── main.tf
│   │   ├── terraform.tfstate
│   │   └── terraform.tfstate.backup
│   ├── asg
│   │   ├── cloudconfig.yml
│   │   ├── main.tf
│   │   ├── terraform.tfstate
│   │   └── terraform.tfstate.backup
│   └── elb
│       ├── main.tf
│       ├── terraform.tfstate
│       └── terraform.tfstate.backup
├── terraform.tfvars
└── tests
    └── load.rb
  </code></pre>
</section></div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
      controls: true,
      progress: true,
      history: true,
      center: true,

      transition: Reveal.getQueryHash().transition || 'slide', // none/fade/slide/convex/concave/zoom

      // Optional reveal.js plugins
      dependencies: [
        //{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        //{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        //{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: 'plugin/zoom-js/zoom.js', async: true },
        { src: 'plugin/notes/notes.js', async: true }
      ]
    });
    </script>

    <script src="js/dynamic-theme.js"></script><script src="js/custom.js"></script>

  </body>
</html>
